{"ast":null,"code":"/**\n * Authentication Service\n * Handles user authentication and session management\n */import ApiService from'./api';class AuthService{static async register(username,email,password,fullName){try{const response=await ApiService.register({username,email,password,fullName});if(response.token){localStorage.setItem('authToken',response.token);localStorage.setItem('user',JSON.stringify(response.user));}return response;}catch(error){console.error('Registration failed:',error);throw error;}}static async login(email,password){try{const response=await ApiService.login(email,password);if(response.token){localStorage.setItem('authToken',response.token);localStorage.setItem('user',JSON.stringify(response.user));}return response;}catch(error){console.error('Login failed:',error);throw error;}}static logout(){ApiService.logout();}static getCurrentUser(){const user=localStorage.getItem('user');return user?JSON.parse(user):null;}static isAuthenticated(){return!!localStorage.getItem('authToken');}static getToken(){return localStorage.getItem('authToken');}static async refreshToken(){try{const response=await ApiService.request('/auth/refresh',{method:'POST'});if(response.token){localStorage.setItem('authToken',response.token);}return response.token;}catch(error){console.error('Token refresh failed:',error);this.logout();throw error;}}static validatePassword(password){// At least 8 characters, 1 uppercase, 1 lowercase, 1 number, 1 special char\nconst regex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;return regex.test(password);}static validateEmail(email){const regex=/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;return regex.test(email);}static validateUsername(username){// 3-20 characters, alphanumeric and underscore only\nconst regex=/^[a-zA-Z0-9_]{3,20}$/;return regex.test(username);}}export default AuthService;","map":{"version":3,"names":["ApiService","AuthService","register","username","email","password","fullName","response","token","localStorage","setItem","JSON","stringify","user","error","console","login","logout","getCurrentUser","getItem","parse","isAuthenticated","getToken","refreshToken","request","method","validatePassword","regex","test","validateEmail","validateUsername"],"sources":["/home/justice/Desktop/chatting-app-1/app/src/utils/auth.js"],"sourcesContent":["/**\n * Authentication Service\n * Handles user authentication and session management\n */\n\nimport ApiService from './api';\n\nclass AuthService {\n  static async register(username, email, password, fullName) {\n    try {\n      const response = await ApiService.register({\n        username,\n        email,\n        password,\n        fullName\n      });\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n\n      return response;\n    } catch (error) {\n      console.error('Registration failed:', error);\n      throw error;\n    }\n  }\n\n  static async login(email, password) {\n    try {\n      const response = await ApiService.login(email, password);\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n\n      return response;\n    } catch (error) {\n      console.error('Login failed:', error);\n      throw error;\n    }\n  }\n\n  static logout() {\n    ApiService.logout();\n  }\n\n  static getCurrentUser() {\n    const user = localStorage.getItem('user');\n    return user ? JSON.parse(user) : null;\n  }\n\n  static isAuthenticated() {\n    return !!localStorage.getItem('authToken');\n  }\n\n  static getToken() {\n    return localStorage.getItem('authToken');\n  }\n\n  static async refreshToken() {\n    try {\n      const response = await ApiService.request('/auth/refresh', {\n        method: 'POST'\n      });\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n      }\n\n      return response.token;\n    } catch (error) {\n      console.error('Token refresh failed:', error);\n      this.logout();\n      throw error;\n    }\n  }\n\n  static validatePassword(password) {\n    // At least 8 characters, 1 uppercase, 1 lowercase, 1 number, 1 special char\n    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\n    return regex.test(password);\n  }\n\n  static validateEmail(email) {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return regex.test(email);\n  }\n\n  static validateUsername(username) {\n    // 3-20 characters, alphanumeric and underscore only\n    const regex = /^[a-zA-Z0-9_]{3,20}$/;\n    return regex.test(username);\n  }\n}\n\nexport default AuthService;\n"],"mappings":"AAAA;AACA;AACA;AACA,GAEA,MAAO,CAAAA,UAAU,KAAM,OAAO,CAE9B,KAAM,CAAAC,WAAY,CAChB,YAAa,CAAAC,QAAQA,CAACC,QAAQ,CAAEC,KAAK,CAAEC,QAAQ,CAAEC,QAAQ,CAAE,CACzD,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAP,UAAU,CAACE,QAAQ,CAAC,CACzCC,QAAQ,CACRC,KAAK,CACLC,QAAQ,CACRC,QACF,CAAC,CAAC,CAEF,GAAIC,QAAQ,CAACC,KAAK,CAAE,CAClBC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEH,QAAQ,CAACC,KAAK,CAAC,CACjDC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAACM,IAAI,CAAC,CAAC,CAC7D,CAEA,MAAO,CAAAN,QAAQ,CACjB,CAAE,MAAOO,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,CAAEA,KAAK,CAAC,CAC5C,KAAM,CAAAA,KAAK,CACb,CACF,CAEA,YAAa,CAAAE,KAAKA,CAACZ,KAAK,CAAEC,QAAQ,CAAE,CAClC,GAAI,CACF,KAAM,CAAAE,QAAQ,CAAG,KAAM,CAAAP,UAAU,CAACgB,KAAK,CAACZ,KAAK,CAAEC,QAAQ,CAAC,CAExD,GAAIE,QAAQ,CAACC,KAAK,CAAE,CAClBC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEH,QAAQ,CAACC,KAAK,CAAC,CACjDC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACL,QAAQ,CAACM,IAAI,CAAC,CAAC,CAC7D,CAEA,MAAO,CAAAN,QAAQ,CACjB,CAAE,MAAOO,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,eAAe,CAAEA,KAAK,CAAC,CACrC,KAAM,CAAAA,KAAK,CACb,CACF,CAEA,MAAO,CAAAG,MAAMA,CAAA,CAAG,CACdjB,UAAU,CAACiB,MAAM,CAAC,CAAC,CACrB,CAEA,MAAO,CAAAC,cAAcA,CAAA,CAAG,CACtB,KAAM,CAAAL,IAAI,CAAGJ,YAAY,CAACU,OAAO,CAAC,MAAM,CAAC,CACzC,MAAO,CAAAN,IAAI,CAAGF,IAAI,CAACS,KAAK,CAACP,IAAI,CAAC,CAAG,IAAI,CACvC,CAEA,MAAO,CAAAQ,eAAeA,CAAA,CAAG,CACvB,MAAO,CAAC,CAACZ,YAAY,CAACU,OAAO,CAAC,WAAW,CAAC,CAC5C,CAEA,MAAO,CAAAG,QAAQA,CAAA,CAAG,CAChB,MAAO,CAAAb,YAAY,CAACU,OAAO,CAAC,WAAW,CAAC,CAC1C,CAEA,YAAa,CAAAI,YAAYA,CAAA,CAAG,CAC1B,GAAI,CACF,KAAM,CAAAhB,QAAQ,CAAG,KAAM,CAAAP,UAAU,CAACwB,OAAO,CAAC,eAAe,CAAE,CACzDC,MAAM,CAAE,MACV,CAAC,CAAC,CAEF,GAAIlB,QAAQ,CAACC,KAAK,CAAE,CAClBC,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEH,QAAQ,CAACC,KAAK,CAAC,CACnD,CAEA,MAAO,CAAAD,QAAQ,CAACC,KAAK,CACvB,CAAE,MAAOM,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAAC,CAC7C,IAAI,CAACG,MAAM,CAAC,CAAC,CACb,KAAM,CAAAH,KAAK,CACb,CACF,CAEA,MAAO,CAAAY,gBAAgBA,CAACrB,QAAQ,CAAE,CAChC;AACA,KAAM,CAAAsB,KAAK,CAAG,sEAAsE,CACpF,MAAO,CAAAA,KAAK,CAACC,IAAI,CAACvB,QAAQ,CAAC,CAC7B,CAEA,MAAO,CAAAwB,aAAaA,CAACzB,KAAK,CAAE,CAC1B,KAAM,CAAAuB,KAAK,CAAG,4BAA4B,CAC1C,MAAO,CAAAA,KAAK,CAACC,IAAI,CAACxB,KAAK,CAAC,CAC1B,CAEA,MAAO,CAAA0B,gBAAgBA,CAAC3B,QAAQ,CAAE,CAChC;AACA,KAAM,CAAAwB,KAAK,CAAG,sBAAsB,CACpC,MAAO,CAAAA,KAAK,CAACC,IAAI,CAACzB,QAAQ,CAAC,CAC7B,CACF,CAEA,cAAe,CAAAF,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}