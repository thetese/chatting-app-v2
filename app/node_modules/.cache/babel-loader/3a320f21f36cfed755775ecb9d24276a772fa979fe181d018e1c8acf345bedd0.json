{"ast":null,"code":"/**\n * Authentication Service\n * Handles user authentication and session management\n */\n\nimport ApiService from './api';\nclass AuthService {\n  static async register(username, email, password, fullName) {\n    try {\n      const response = await ApiService.register({\n        username,\n        email,\n        password,\n        fullName\n      });\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n      return response;\n    } catch (error) {\n      console.error('Registration failed:', error);\n      throw error;\n    }\n  }\n  static async login(email, password) {\n    try {\n      const response = await ApiService.login(email, password);\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n      return response;\n    } catch (error) {\n      console.error('Login failed:', error);\n      throw error;\n    }\n  }\n  static logout() {\n    ApiService.logout();\n  }\n  static getCurrentUser() {\n    const user = localStorage.getItem('user');\n    return user ? JSON.parse(user) : null;\n  }\n  static isAuthenticated() {\n    return !!localStorage.getItem('authToken');\n  }\n  static getToken() {\n    return localStorage.getItem('authToken');\n  }\n  static async refreshToken() {\n    try {\n      const response = await ApiService.request('/auth/refresh', {\n        method: 'POST'\n      });\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n      }\n      return response.token;\n    } catch (error) {\n      console.error('Token refresh failed:', error);\n      this.logout();\n      throw error;\n    }\n  }\n  static validatePassword(password) {\n    // At least 8 characters, 1 uppercase, 1 lowercase, 1 number, 1 special char\n    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\n    return regex.test(password);\n  }\n  static validateEmail(email) {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return regex.test(email);\n  }\n  static validateUsername(username) {\n    // 3-20 characters, alphanumeric and underscore only\n    const regex = /^[a-zA-Z0-9_]{3,20}$/;\n    return regex.test(username);\n  }\n}\nexport default AuthService;","map":{"version":3,"names":["ApiService","AuthService","register","username","email","password","fullName","response","token","localStorage","setItem","JSON","stringify","user","error","console","login","logout","getCurrentUser","getItem","parse","isAuthenticated","getToken","refreshToken","request","method","validatePassword","regex","test","validateEmail","validateUsername"],"sources":["/home/justice/Desktop/chatting-app-1/app/src/utils/auth.js"],"sourcesContent":["/**\n * Authentication Service\n * Handles user authentication and session management\n */\n\nimport ApiService from './api';\n\nclass AuthService {\n  static async register(username, email, password, fullName) {\n    try {\n      const response = await ApiService.register({\n        username,\n        email,\n        password,\n        fullName\n      });\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n\n      return response;\n    } catch (error) {\n      console.error('Registration failed:', error);\n      throw error;\n    }\n  }\n\n  static async login(email, password) {\n    try {\n      const response = await ApiService.login(email, password);\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n        localStorage.setItem('user', JSON.stringify(response.user));\n      }\n\n      return response;\n    } catch (error) {\n      console.error('Login failed:', error);\n      throw error;\n    }\n  }\n\n  static logout() {\n    ApiService.logout();\n  }\n\n  static getCurrentUser() {\n    const user = localStorage.getItem('user');\n    return user ? JSON.parse(user) : null;\n  }\n\n  static isAuthenticated() {\n    return !!localStorage.getItem('authToken');\n  }\n\n  static getToken() {\n    return localStorage.getItem('authToken');\n  }\n\n  static async refreshToken() {\n    try {\n      const response = await ApiService.request('/auth/refresh', {\n        method: 'POST'\n      });\n\n      if (response.token) {\n        localStorage.setItem('authToken', response.token);\n      }\n\n      return response.token;\n    } catch (error) {\n      console.error('Token refresh failed:', error);\n      this.logout();\n      throw error;\n    }\n  }\n\n  static validatePassword(password) {\n    // At least 8 characters, 1 uppercase, 1 lowercase, 1 number, 1 special char\n    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\n    return regex.test(password);\n  }\n\n  static validateEmail(email) {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return regex.test(email);\n  }\n\n  static validateUsername(username) {\n    // 3-20 characters, alphanumeric and underscore only\n    const regex = /^[a-zA-Z0-9_]{3,20}$/;\n    return regex.test(username);\n  }\n}\n\nexport default AuthService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}